package com.hc.work;

import com.alibaba.excel.EasyExcel;
import com.alibaba.excel.ExcelWriter;
import com.alibaba.excel.write.metadata.WriteSheet;
import com.hc.util.EasyExcelUtils;
import jakarta.annotation.Resource;
import lombok.extern.slf4j.Slf4j;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.web.client.RestTemplate;

import java.util.*;
import java.util.function.Consumer;
import java.util.function.Function;

/**
 * 类描述: 工作相关的http接口
 *
 * @author: HuangChao
 * @since: 2025/04/10
 */
@Slf4j
@SpringBootTest
public class TrackTaskTest {

    @Resource
    private RestTemplate restTemplate;

    private static final String urlTemplate = "https://admin.xiujiadian.com/bfm-serv-work-scheduling/test/twd/closeById?twdId=%s&cleanTimeoutInfo=%s";

    public static final List<Integer> STAFF_ID_LIST = List.of(
            14144008,14148839,14147371,14147037,14143036,14151219,14156244,14156243,14156242,14146184,14147110,14146806,14147125,14146308,14154750,14155960,14151836,14147825,14154721,14144165,14143883,14147028,143307,14148178,14150034,14149995,14143326,14148542,14146076,14151975,14151060,14153265,14142222,14154072,14139431,14143052,14155707,14156176,14152738,14153515,14142201,14147145,14147705,14146071,14143371,14156196,14156194,14154615,14155854,14146457,14143356,14151534,14155985,14143061,14144955,14154214,14155130,14146546,14143931,14156178,14153783,14144372,14139757,29337,14153680,14154040,14154893,14141780,14152274,14154306,22894,14141571,14151143,14154307,14142348,14147650,14155994,14148258,14147656,14153357,14143737,14146615,14153647,14153975,14143257,14147133,14156162,14151648,14153460,14152027,14154800,14145520,14151869,14153247,23763,14142658,14149239,29121,24819,14147449,14147658,14143255,14147653,14156028,14150032,14146220,14140226,14145517,14148592,14155381,14154323,14153157,14153940,14156123,14144105,14151463,14147575,14150775,14146197,14150774,14147113,14140177,14151054,14156153,14153852,14152677,14147105,14147131,14153547,14146522,14152394,14152391,14153059,14146574,14140478,14152183,142880,14144318,14147004,18803,23940,14155983,15317,163527,14144070,14153472,14155804,14155857,14147432,140180,14142650,14154189,14141789,14155192,14146518,14156011,14155875,14151841,14144577,14153963,14155981,23560,31521,14148134,14153376,14141194,14152342,14143632,14141161,14153627,14147843,14147376,14146510,14148572,14152767,14156041,14154071,14152136,14146458,14156122,14143614,14149537,14154061,14151222,14153866,14146090,14140347,14155764,14148861,31920,14143111,14147245,14152968,14147250,14144275,14147669,14151445,14146189,14153209,14152330,14156090,14144638,14153968,14151045,14152874,14152139,14144960,14156089,14149831,14156088,14143663,14152572,14146966,14142048,14144640,14150860,14147402,14147248,14138979,14142480,14146114,14142277,14153183,14147571,14141344,14154218,14146988,14154216,14140186,14141345,14155980,14156010,20862,14141857,14140800,14152442,28563,14154304,14155288,14142930,14151838,14147829,14151840,14151835,14151844,14151837,14153543,14153542,14146363,14151843,14140336,14154057,14152401,14151699,14145033,14151696,14152399,14146249,14140151,14154378,14148368,14151711,14141635,14146804,14156068,14153854,14148837,14146454,14141348,163531,14155843,14144876,14140538,14151928,14152031,14155932,14146317,14151927,14151930,14154162,14155879,14152244,14153934,14147346,14144407,14143933,14156058,14149039,14146138,14151649,14151658,14146396,14147903,14154372,14156060,14150186,14146917,14142618,14142289,14156039,14152873,14146292,14146914,14142703,14143675,14152869,14156038,14144843,14147249,14142178,14152785,14156055,14144570,14146407,14143413,14156054,14142583,14146990,14142531,14142535,14143837,14150351,14144571,14144757,14144753,14146772,14144756,14155871,14154207,14150786,14154696,14146312,14146784,14146782,14144752,14152752,14143426,14149501,14155634,14151153,14155802,14146311,14151339,14154229,14142496,14142188,14142258,14143456,14139510,14148983,143506,14151971,142021,14144071,14147841,14146537,14151371,14148548,14149385,14154340,14146698,14146538,14146898,14146536,14151370,14150771,14156056,14155055,14152094,14155851,14147590,14152730,14152729,14155057,14156063,14152809,14140061,14146188,14150820,14145221,143481,14150819,14154594,14143742,14146040,14156066,14153856,14156065,163393,14143988,14146856,14149573,14152840,14153772,14151108,14153773,14152147,14156034,20705,14147077,14147075,14151956,14149384,14146531,14152236,14146361,14151521,14149068,14154382,14146838,14152257,14151782,14144709,14139787,14149106,14143469,14154159,14154312,14146731,14151811,14154202,14152277,14154201,14141213,14141915,14141826,14146616,14143374,14149064,14151796,14152220,14142584,14155628,140503,140272,20069,14139641,14146411,14140560,14149560,14153834,13007,14141307,14155601,160888,14141212,14146646,14147088,14146418,161197,14144635,14146364,14141797,21779,14146962,14143554,14152167,14151584,14154326,14142094,14145883,14146705,14142578,14153367,14153536,14146181,14156033,14148284,14148280,14148283,14144871,14150813,14153462,14154252,14146682,14141838,14142613,14143098,14141295,14155887,14152564,14152154,14149577,14154311,14153920,14141531,14144840,21172,14146971,140486,14155573,14146198,14148282,14153686,14147828,28810,14156023,14153677,20005,142081,14146492,14146186,14156014,14144634,14151735,14154541,14153015,14142581,14153830,14143654,14155968,14147609,14144364,14147872,14155973,14146232,14155996,14154264,14152182,14144427,14153784,14155557,14149504,14153368,14141493,14151660,14154334,14153497,14141633,14146174,14148189,14144321,14149999,14150477,14155961,14144341,14147202,14149659,14148568,14143441,14152141,14154014,14146477,14153879,14153770,14142223,14151049,14146351,14150365,14144978,13554,14146295,14155959,14146368,14146360,14153551,14144294,14153782,14144316,23886,14153871,14155880,14144005,14151080,14147027,14151624,14143180,14151097,14154054,14143432,140156,14144232,14153896,14155805,14155942,14143555,14155884,14152029,14146023,14151665,14141191,14151916,14152652,14143531,14152648,14153897,14154736,14152654,14151532,14152762,14143557,14146694,14144688,14146692,14151334,14154184,14154186,14146693,14147231,14149608,14141332,14140820,14140017,14140021,14146108,14153810,14147230,14145507,14140019,14142095,14150178,14152362,14147143,14155882,14143093,14150140,14147140,14142117,14151541,14152832,14154328,14142523,14152016,14153827,14144696,14141941,14153764,14153851,14151536,14154657,14151728,14140047,14152823,14151725,14149314,14151727,14154134,14142525,14155624,143596,14152836,15698,14155761,14150730,14147934,14155561,14146353,14152650,14143945,14143552,14149122,14140147,14152842,14147268,14152112,14146424,14147272,14146903,14148101,14143358,14146453,14152897,14148087,14144348,14148205,14144201,14147102,14149780,14152748,14147098,14153876,14155335,14154451,14155170,14153915,14152366,14155546,14149535,14144375,14154315,14153272,14155847,14154658,14151739,14151737,14152382,14148193,14153790,14153794,14149268,14153789,14149272,14155626,14149270,14155599,14142192,14155017,14142465,14155850,14141174,14153286,14144975,14154607,14150293,14144668,14149380,14147221,14144974,14143537,14155625,14151957,14139861,14152149,14151077,14151075,14151073,14151071,14154724,14155562,14151217,140527,14145088,14154723,14142217,14154722,14147937,14155842,14146700,14153537,22522,14143505,14151379,14141380,14146683,14143506,14153786,14148222,14144162,14143567,14151378,30635,14146358,14140348,160861,14149543,14146315,14152984,14153273,14146262,14149702,14154961,14155300,14148754,14146853,14145855,14148735,14154176,14153878,14146433,14149632,14154173,14152570,14155706,14148563,14153499,14153496,14143578,14143574,14152177,14145905,14152169,14152208,14146604,14151762,14154034,14149851,14142221,14144319,14144317,14153512,14152018,14147846,14149058,14153372,14153538,14143813,14152020,14147006,14144589,14142910,14141253,14147007,14154277,14143177,14139384,14153682,10310,14139843,14143811,14149403,14143361,14146173,14153628,14141351,14140103,14146992,14153661,14155651,14144182,14154011,14149566,14155679,14147382,14144293,14144286,14148576,14154720,14144290,14155329,14148536,14141825,14139795,14153109,14145551,14147388,14144819,14143053,14146961,14145550,14145790,14149113,14143968,14146657,14155553,14155496,14153867,14148554,14154655,14154659,14143569,14155307,14152776,14143571,14140160,14152489,14155309,163535,14147438,14142646,14150955,14147441,14152488,14146603,14150366,14148533,14149710,14151443,14147587,14143638,14152389,14145659,14152679,14139804,14149611,14149540,14143494,14143677,14142645,14149111,14144060,14144941,14143823,14150867,14138815,14142349,14140197,24222,14140236,11192,14152645,14152646,14143532,14144412,14143421,14146876,14144088,14147400,14146768,14149203,14153518,14146926,14153931,14151787,14143439,14146376,14141854,28274,14147415,14147416,14147413,14147414,14148114,14153268,14143485,14146765,14149342,14143501,14147779,14153168,30409,14144289,14151732,14148574,14140349,14144287,14153631
    );

    private static final List<Integer> BIZ_LINE_LIST = List.of(
            1000, 1002, 1001, 1014, 1004, 1005, 1007
    );
    private static final List<Integer> PRODUCT_GROUP_LIST = List.of(
            1013, 1015, 1016, 1014, 1035, 1033, 1028, 1020, 1023, 1021, 1022, 1024, 1018, 1000, 1031, 1003, 1005, 1019, 1034, 1026, 1030, 1029, 1008, 1036, 1037
    );
    private static final Map<Integer, Integer> CITY_MAP = new HashMap<>();
    {
        CITY_MAP.put(110100,110000);
        CITY_MAP.put(442000580,440000);
        CITY_MAP.put(442000581,440000);
        CITY_MAP.put(442019615,440000);
        CITY_MAP.put(310100,310000);
        CITY_MAP.put(120100,120000);
        CITY_MAP.put(500100,500000);
        CITY_MAP.put(510100,510000);
        CITY_MAP.put(440100,440000);
        CITY_MAP.put(450100,450000);
        CITY_MAP.put(370100,370000);
        CITY_MAP.put(140100,140000);
        CITY_MAP.put(320100,320000);
        CITY_MAP.put(442000543,440000);
        CITY_MAP.put(330100,330000);
        CITY_MAP.put(350100,350000);
        CITY_MAP.put(430100,430000);
        CITY_MAP.put(420100,420000);
        CITY_MAP.put(130100,130000);
        CITY_MAP.put(340100,340000);
        CITY_MAP.put(360100,360000);
        CITY_MAP.put(610100,610000);
        CITY_MAP.put(620100,620000);
        CITY_MAP.put(520100,520000);
        CITY_MAP.put(530100,530000);
        CITY_MAP.put(230100,230000);
        CITY_MAP.put(220100,220000);
        CITY_MAP.put(210100,210000);
        CITY_MAP.put(460100,460000);
        CITY_MAP.put(630100,630000);
        CITY_MAP.put(150100,150000);
        CITY_MAP.put(640100,640000);
        CITY_MAP.put(650100,650000);
        CITY_MAP.put(540100,540000);
        CITY_MAP.put(410100,410000);
        CITY_MAP.put(820054,820000);
        CITY_MAP.put(542100,540000);
        CITY_MAP.put(442000126,440000);
        CITY_MAP.put(442000136,440000);
        CITY_MAP.put(442000143,440000);
        CITY_MAP.put(442000144,440000);
        CITY_MAP.put(442000145,440000);
        CITY_MAP.put(442000169,440000);
        CITY_MAP.put(442000170,440000);
        CITY_MAP.put(442000171,440000);
        CITY_MAP.put(442000172,440000);
        CITY_MAP.put(442000288,440000);
        CITY_MAP.put(442000308,440000);
        CITY_MAP.put(442000323,440000);
        CITY_MAP.put(442000331,440000);
        CITY_MAP.put(442000343,440000);
        CITY_MAP.put(442000345,440000);
        CITY_MAP.put(442000412,440000);
        CITY_MAP.put(442000426,440000);
        CITY_MAP.put(442000456,440000);
        CITY_MAP.put(442000461,440000);
        CITY_MAP.put(442000476,440000);
        CITY_MAP.put(442000490,440000);
        CITY_MAP.put(442000512,440000);
        CITY_MAP.put(510700,510000);
        CITY_MAP.put(510600,510000);
        CITY_MAP.put(511300,510000);
        CITY_MAP.put(511500,510000);
        CITY_MAP.put(510300,510000);
        CITY_MAP.put(511600,510000);
        CITY_MAP.put(511100,510000);
        CITY_MAP.put(510500,510000);
        CITY_MAP.put(511700,510000);
        CITY_MAP.put(511000,510000);
        CITY_MAP.put(510900,510000);
        CITY_MAP.put(510400,510000);
        CITY_MAP.put(511400,510000);
        CITY_MAP.put(512000,510000);
        CITY_MAP.put(513400,510000);
        CITY_MAP.put(510800,510000);
        CITY_MAP.put(511800,510000);
        CITY_MAP.put(511900,510000);
        CITY_MAP.put(513200,510000);
        CITY_MAP.put(513300,510000);
        CITY_MAP.put(440300,440000);
        CITY_MAP.put(441900,440000);
        CITY_MAP.put(440600,440000);
        CITY_MAP.put(440400,440000);
        CITY_MAP.put(441300,440000);
        CITY_MAP.put(442000,440000);
        CITY_MAP.put(440700,440000);
        CITY_MAP.put(440500,440000);
        CITY_MAP.put(440800,440000);
        CITY_MAP.put(441200,440000);
        CITY_MAP.put(440900,440000);
        CITY_MAP.put(445200,440000);
        CITY_MAP.put(441400,440000);
        CITY_MAP.put(445100,440000);
        CITY_MAP.put(441800,440000);
        CITY_MAP.put(441700,440000);
        CITY_MAP.put(440200,440000);
        CITY_MAP.put(441600,440000);
        CITY_MAP.put(445300,440000);
        CITY_MAP.put(441500,440000);
        CITY_MAP.put(370200,370000);
        CITY_MAP.put(450200,450000);
        CITY_MAP.put(450300,450000);
        CITY_MAP.put(450900,450000);
        CITY_MAP.put(450400,450000);
        CITY_MAP.put(640400,640000);
        CITY_MAP.put(450500,450000);
        CITY_MAP.put(450800,450000);
        CITY_MAP.put(450700,450000);
        CITY_MAP.put(451000,450000);
        CITY_MAP.put(451200,450000);
        CITY_MAP.put(451300,450000);
        CITY_MAP.put(451100,450000);
        CITY_MAP.put(450600,450000);
        CITY_MAP.put(451400,450000);
        CITY_MAP.put(370600,370000);
        CITY_MAP.put(370700,370000);
        CITY_MAP.put(371300,370000);
        CITY_MAP.put(370300,370000);
        CITY_MAP.put(370800,370000);
        CITY_MAP.put(370900,370000);
        CITY_MAP.put(371500,370000);
        CITY_MAP.put(371000,370000);
        CITY_MAP.put(370400,370000);
        CITY_MAP.put(371100,370000);
        CITY_MAP.put(370500,370000);
        CITY_MAP.put(652200,650000);
        CITY_MAP.put(371400,370000);
        CITY_MAP.put(371700,370000);
        CITY_MAP.put(371600,370000);
        CITY_MAP.put(653200,650000);
        CITY_MAP.put(141000,140000);
        CITY_MAP.put(140200,140000);
        CITY_MAP.put(140800,140000);
        CITY_MAP.put(140700,140000);
        CITY_MAP.put(140400,140000);
        CITY_MAP.put(140500,140000);
        CITY_MAP.put(140300,140000);
        CITY_MAP.put(141100,140000);
        CITY_MAP.put(140900,140000);
        CITY_MAP.put(140600,140000);
        CITY_MAP.put(320500,320000);
        CITY_MAP.put(320200,320000);
        CITY_MAP.put(820058,820000);
        CITY_MAP.put(320400,320000);
        CITY_MAP.put(320300,320000);
        CITY_MAP.put(320600,320000);
        CITY_MAP.put(321000,320000);
        CITY_MAP.put(320900,320000);
        CITY_MAP.put(320800,320000);
        CITY_MAP.put(320700,320000);
        CITY_MAP.put(321200,320000);
        CITY_MAP.put(321300,320000);
        CITY_MAP.put(321100,320000);
        CITY_MAP.put(330500,330000);
        CITY_MAP.put(330400,330000);
        CITY_MAP.put(330700,330000);
        CITY_MAP.put(331100,330000);
        CITY_MAP.put(330200,330000);
        CITY_MAP.put(330800,330000);
        CITY_MAP.put(330600,330000);
        CITY_MAP.put(331000,330000);
        CITY_MAP.put(330300,330000);
        CITY_MAP.put(330900,330000);
        CITY_MAP.put(542600,540000);
        CITY_MAP.put(350200,350000);
        CITY_MAP.put(350500,350000);
        CITY_MAP.put(350300,350000);
        CITY_MAP.put(350600,350000);
        CITY_MAP.put(350900,350000);
        CITY_MAP.put(350400,350000);
        CITY_MAP.put(350700,350000);
        CITY_MAP.put(350800,350000);
        CITY_MAP.put(542400,540000);
        CITY_MAP.put(430200,430000);
        CITY_MAP.put(430900,430000);
        CITY_MAP.put(430700,430000);
        CITY_MAP.put(430400,430000);
        CITY_MAP.put(430300,430000);
        CITY_MAP.put(430600,430000);
        CITY_MAP.put(431000,430000);
        CITY_MAP.put(430500,430000);
        CITY_MAP.put(431200,430000);
        CITY_MAP.put(431100,430000);
        CITY_MAP.put(431300,430000);
        CITY_MAP.put(433100,430000);
        CITY_MAP.put(430800,430000);
        CITY_MAP.put(420500,420000);
        CITY_MAP.put(420600,420000);
        CITY_MAP.put(421000,420000);
        CITY_MAP.put(420300,420000);
        CITY_MAP.put(420200,420000);
        CITY_MAP.put(420900,420000);
        CITY_MAP.put(421100,420000);
        CITY_MAP.put(422800,420000);
        CITY_MAP.put(429100,420000);
        CITY_MAP.put(130600,130000);
        CITY_MAP.put(542300,540000);
        CITY_MAP.put(130200,130000);
        CITY_MAP.put(131000,130000);
        CITY_MAP.put(130400,130000);
        CITY_MAP.put(130300,130000);
        CITY_MAP.put(130900,130000);
        CITY_MAP.put(130500,130000);
        CITY_MAP.put(131100,130000);
        CITY_MAP.put(130700,130000);
        CITY_MAP.put(130800,130000);
        CITY_MAP.put(410500,410000);
        CITY_MAP.put(410600,410000);
        CITY_MAP.put(411900,410000);
        CITY_MAP.put(410800,410000);
        CITY_MAP.put(410200,410000);
        CITY_MAP.put(410300,410000);
        CITY_MAP.put(411100,410000);
        CITY_MAP.put(411300,410000);
        CITY_MAP.put(410900,410000);
        CITY_MAP.put(410400,410000);
        CITY_MAP.put(411200,410000);
        CITY_MAP.put(542200,540000);
        CITY_MAP.put(411400,410000);
        CITY_MAP.put(411500,410000);
        CITY_MAP.put(410700,410000);
        CITY_MAP.put(411000,410000);
        CITY_MAP.put(411600,410000);
        CITY_MAP.put(411700,410000);
        CITY_MAP.put(820060,820000);
        CITY_MAP.put(640200,640000);
        CITY_MAP.put(820061,820000);
        CITY_MAP.put(340800,340000);
        CITY_MAP.put(340300,340000);
        CITY_MAP.put(341600,340000);
        CITY_MAP.put(341100,340000);
        CITY_MAP.put(341700,340000);
        CITY_MAP.put(341200,340000);
        CITY_MAP.put(341000,340000);
        CITY_MAP.put(340600,340000);
        CITY_MAP.put(820063,820000);
        CITY_MAP.put(340400,340000);
        CITY_MAP.put(341500,340000);
        CITY_MAP.put(340500,340000);
        CITY_MAP.put(341300,340000);
        CITY_MAP.put(340700,340000);
        CITY_MAP.put(820065,820000);
        CITY_MAP.put(340200,340000);
        CITY_MAP.put(341800,340000);
        CITY_MAP.put(652100,650000);
        CITY_MAP.put(361000,360000);
        CITY_MAP.put(360700,360000);
        CITY_MAP.put(360400,360000);
        CITY_MAP.put(360800,360000);
        CITY_MAP.put(360200,360000);
        CITY_MAP.put(360300,360000);
        CITY_MAP.put(361100,360000);
        CITY_MAP.put(360500,360000);
        CITY_MAP.put(360900,360000);
        CITY_MAP.put(640300,640000);
        CITY_MAP.put(360600,360000);
        CITY_MAP.put(820066,820000);
        CITY_MAP.put(610900,610000);
        CITY_MAP.put(610300,610000);
        CITY_MAP.put(610700,610000);
        CITY_MAP.put(611000,610000);
        CITY_MAP.put(610200,610000);
        CITY_MAP.put(610500,610000);
        CITY_MAP.put(610400,610000);
        CITY_MAP.put(610600,610000);
        CITY_MAP.put(420800,420000);
        CITY_MAP.put(610800,610000);
        CITY_MAP.put(421200,420000);
        CITY_MAP.put(420700,420000);
        CITY_MAP.put(421300,420000);
        CITY_MAP.put(820043,820000);
        CITY_MAP.put(820042,820000);
        CITY_MAP.put(429300,420000);
        CITY_MAP.put(622900,620000);
        CITY_MAP.put(620400,620000);
        CITY_MAP.put(620200,620000);
        CITY_MAP.put(621100,620000);
        CITY_MAP.put(620300,620000);
        CITY_MAP.put(620900,620000);
        CITY_MAP.put(623000,620000);
        CITY_MAP.put(621200,620000);
        CITY_MAP.put(620800,620000);
        CITY_MAP.put(621000,620000);
        CITY_MAP.put(620500,620000);
        CITY_MAP.put(620600,620000);
        CITY_MAP.put(620700,620000);
        CITY_MAP.put(520400,520000);
        CITY_MAP.put(522400,520000);
        CITY_MAP.put(520200,520000);
        CITY_MAP.put(522300,520000);
        CITY_MAP.put(522600,520000);
        CITY_MAP.put(522700,520000);
        CITY_MAP.put(522200,520000);
        CITY_MAP.put(520300,520000);
        CITY_MAP.put(640500,640000);
        CITY_MAP.put(530500,530000);
        CITY_MAP.put(532300,530000);
        CITY_MAP.put(532900,530000);
        CITY_MAP.put(533100,530000);
        CITY_MAP.put(533400,530000);
        CITY_MAP.put(532500,530000);
        CITY_MAP.put(530700,530000);
        CITY_MAP.put(530900,530000);
        CITY_MAP.put(533300,530000);
        CITY_MAP.put(530800,530000);
        CITY_MAP.put(532800,530000);
        CITY_MAP.put(530300,530000);
        CITY_MAP.put(532600,530000);
        CITY_MAP.put(530400,530000);
        CITY_MAP.put(530600,530000);
        CITY_MAP.put(230600,230000);
        CITY_MAP.put(230400,230000);
        CITY_MAP.put(231100,230000);
        CITY_MAP.put(230300,230000);
        CITY_MAP.put(231000,230000);
        CITY_MAP.put(230900,230000);
        CITY_MAP.put(230200,230000);
        CITY_MAP.put(230500,230000);
        CITY_MAP.put(231200,230000);
        CITY_MAP.put(230700,230000);
        CITY_MAP.put(230800,230000);
        CITY_MAP.put(232700,230000);
        CITY_MAP.put(220800,220000);
        CITY_MAP.put(220600,220000);
        CITY_MAP.put(220200,220000);
        CITY_MAP.put(220400,220000);
        CITY_MAP.put(220300,220000);
        CITY_MAP.put(220700,220000);
        CITY_MAP.put(220500,220000);
        CITY_MAP.put(222400,220000);
        CITY_MAP.put(210300,210000);
        CITY_MAP.put(210500,210000);
        CITY_MAP.put(211300,210000);
        CITY_MAP.put(210200,210000);
        CITY_MAP.put(210600,210000);
        CITY_MAP.put(210400,210000);
        CITY_MAP.put(210900,210000);
        CITY_MAP.put(211400,210000);
        CITY_MAP.put(210700,210000);
        CITY_MAP.put(211000,210000);
        CITY_MAP.put(211100,210000);
        CITY_MAP.put(211200,210000);
        CITY_MAP.put(210800,210000);
        CITY_MAP.put(461300,460000);
        CITY_MAP.put(460600,460000);
        CITY_MAP.put(461100,460000);
        CITY_MAP.put(461000,460000);
        CITY_MAP.put(461400,460000);
        CITY_MAP.put(460700,460000);
        CITY_MAP.put(460800,460000);
        CITY_MAP.put(460200,460000);
        CITY_MAP.put(461200,460000);
        CITY_MAP.put(460300,460000);
        CITY_MAP.put(460500,460000);
        CITY_MAP.put(460900,460000);
        CITY_MAP.put(460400,460000);
        CITY_MAP.put(461500,460000);
        CITY_MAP.put(461600,460000);
        CITY_MAP.put(461700,460000);
        CITY_MAP.put(462000,460000);
        CITY_MAP.put(632100,630000);
        CITY_MAP.put(632200,630000);
        CITY_MAP.put(632300,630000);
        CITY_MAP.put(632500,630000);
        CITY_MAP.put(632600,630000);
        CITY_MAP.put(632700,630000);
        CITY_MAP.put(632800,630000);
        CITY_MAP.put(150200,150000);
        CITY_MAP.put(150400,150000);
        CITY_MAP.put(150700,150000);
        CITY_MAP.put(150500,150000);
        CITY_MAP.put(150300,150000);
        CITY_MAP.put(152200,150000);
        CITY_MAP.put(150600,150000);
        CITY_MAP.put(150800,150000);
        CITY_MAP.put(150900,150000);
        CITY_MAP.put(152500,150000);
        CITY_MAP.put(152900,150000);
        CITY_MAP.put(652800,650000);
        CITY_MAP.put(652300,650000);
        CITY_MAP.put(542500,540000);
        CITY_MAP.put(653100,650000);
        CITY_MAP.put(820055,820000);
        CITY_MAP.put(820056,820000);
        CITY_MAP.put(652900,650000);
        CITY_MAP.put(442019697,440000);
        CITY_MAP.put(654200,650000);
        CITY_MAP.put(652700,650000);
        CITY_MAP.put(654000,650000);
        CITY_MAP.put(653000,650000);
        CITY_MAP.put(650200,650000);
        CITY_MAP.put(654300,650000);

    }



    @Test
    void testAddConfStaff() {
        String lineSqlTemplate = "INSERT INTO biz_track_task.conf_staff_biz_line (staff_id, biz_line_id, creater, updater) VALUES (%s, %s, '批量初始化', '批量初始化');";
        String productGroupSqlTemplate = "INSERT INTO biz_track_task.conf_staff_product_group (staff_id, product_group_id, creater, updater) VALUES (%s, %s, '批量初始化',  '批量初始化');";
        String citySqlTemplate = "INSERT INTO biz_track_task.conf_staff_city (staff_id, province_id, city_id, creater, updater) VALUES (%s, %s, %s, '批量初始化', '批量初始化');";

        List<List<String>> sqlList = new ArrayList<>();

        STAFF_ID_LIST.forEach(staffId -> {

            BIZ_LINE_LIST.forEach(bizLineId -> {
                sqlList.add(Collections.singletonList(String.format(lineSqlTemplate, staffId, bizLineId)));
            });

            PRODUCT_GROUP_LIST.forEach(productGroupId -> {
                sqlList.add(Collections.singletonList(String.format(productGroupSqlTemplate, staffId, productGroupId)));
            });

            CITY_MAP.forEach((cityId, provinceId) -> {
                sqlList.add(Collections.singletonList(String.format(citySqlTemplate, staffId, provinceId, cityId)));
            });
        });

        // 创建ExcelWriter对象
        String fileName = "file/sql.xlsx";
        ExcelWriter excelWriter = null;
        try {
            excelWriter = EasyExcel.write(fileName).build();

            // 创建Sheet并设置表头
            WriteSheet writeSheet = EasyExcel.writerSheet("Sheet1").build();
            List<List<String>> head = new ArrayList<>();
            head.add(Arrays.asList("sql"));
            excelWriter.write(head, writeSheet);

            // 写入数据
            excelWriter.write(sqlList, writeSheet);
        } catch (Exception e) {
            log.error("写入Excel文件失败", e);
        } finally {
            if (excelWriter != null) {
                excelWriter.finish();
            }
        }
    }

    @Test
    void testCloseTrackTask() {
        // 读取Excel获取ID
        // 读取的excel文件路径
        String fileName = "file/biz_track_task_track_task_in_progress.xlsx";

        // 默认清理超时数据
        // 拼接请求url
        Integer cleanTimeoutInfo = 2;
        Function<Map, String> function = data -> String.format(urlTemplate, data.get(0), cleanTimeoutInfo);

        // 触发请求
        Consumer<String> consumer = data -> {
            Object forObject = restTemplate.getForObject(data, Object.class);
            System.out.println("url:" + data + " 结果：" + forObject);

            try {
                // 休眠5秒
                Thread.sleep(5000L);
            } catch (InterruptedException e) {
                log.warn("线程休眠失败");
            }
        };

        // 读取excel
        EasyExcel.read(fileName, EasyExcelUtils.getSingleReadListener(function, consumer))
                .sheet()
                // 第2行 为第一条数据
                .headRowNumber(1).doRead();

    }

    @Test
    void closeTrackTask() {
        // 拼接请求url
        Integer cleanTimeoutInfo = 2;

        List<Long> taskIds = List.of(
                122906730075638657L
        );

        taskIds.forEach(taskId -> {
            String url = String.format(urlTemplate, taskId, cleanTimeoutInfo);
            Object forObject = restTemplate.getForObject(url, Object.class);
            System.out.println("url:" + url + " 结果：" + forObject);

            try {
                // 休眠5秒
                Thread.sleep(5000L);
            } catch (InterruptedException e) {
                log.warn("线程休眠失败");
            }
        });
    }

}
